----- select * from opm_REGION_cash order by plan_year,lpad( order_code, 10, '0' ); delete from opm_REGION_cash
create or replace PROCEDURE "P_OPM_INIT_REGION_CASH" (planyear IN number--计划年
,regionCompanyId IN VARCHAR2--区域公司id
) AS-- 根据模板初始化年度【区域级数据】---现金流
-- 注意：初始化结构顺序及公式、具体值由区域级提交后汇总
--作者： chenl--日期： 2021/08/24 FIELDSINFO SYS_REFCURSOR;
--是否引入全部模板
init_all   VARCHAR2(500):=(case when regionCompanyId is null or regionCompanyId='' then 1 else 0 end); 
BEGIN 
-----------------------------------现金流
--删除该年；
DELETE FROM opm_REGION_cash WHERE (BELONG_REGION_ID=regionCompanyId or 1=init_all) and plan_year=planyear ;
--根据模板初始化该年
INSERT INTO opm_REGION_cash (id,plan_year,parent_id,object_id,object_name,object_type,order_code,level_code,fma_cash_remaining_amount,fma_sales_collection,fma_rental_income,fma_increase_loan,fma_collection_loan,fma_shareholder_input,fma_investment_input,fma_other_input,fma_total_source_funds,fma_land_cost,fma_engineering_expenditure,fma_development_overhead,fma_expenses_the_period,fma_taxes,fma_pre_payment,fma_other_expenses,fma_current_expenditure,fma_subtotal_fund,fma_flow_funds,fma_remaining_amount,fma_available_funds)
SELECT sys_guid (),planyear,parent_id,id,object_name,object_type,order_code,level_code,fma_cash_remaining_amount,fma_sales_collection,fma_rental_income,fma_increase_loan,fma_collection_loan,fma_shareholder_input,fma_investment_input,fma_other_input,fma_total_source_funds,fma_land_cost,fma_engineering_expenditure,fma_development_overhead,fma_expenses_the_period,fma_taxes,fma_pre_payment,fma_other_expenses,fma_current_expenditure,fma_subtotal_fund,fma_flow_funds,fma_remaining_amount,fma_available_funds 
FROM opm_t_REGION_cash  WHERE BELONG_REGION_ID=regionCompanyId or 1=init_all ;
-----------------------------------现金流
END P_OPM_INIT_REGION_CASH;
/
----- select * from opm_REGION_cash order by plan_year,lpad( order_code, 10, '0' ); delete from opm_REGION_cash
CREATE OR REPLACE PROCEDURE "P_OPM_INIT_REGION_INVENTORY" (planyear IN number--计划年
,regionCompanyId IN VARCHAR2--区域公司id
) AS-- 根据模板初始化年度【区域级数据】---供销存
-- 注意：初始化结构顺序及公式、具体值由区域级提交后汇总
--作者： chenl--日期： 2021/08/24 FIELDSINFO SYS_REFCURSOR;
--是否引入全部模板
init_all   VARCHAR2(500):=(case when regionCompanyId is null or regionCompanyId='' then 1 else 0 end); 
BEGIN 
-----------------------------------供销存
--删除该年；
DELETE FROM OPM_REGION_INVENTORY_PLAN WHERE (BELONG_REGION_ID=regionCompanyId or 1=init_all) and plan_year=planyear ;
INSERT INTO opm_REGION_inventory_plan (id,plan_year,parent_id,level_code,order_code,object_id,object_name,object_type,saleable_area,saleable_number,saleable_amount,saleable_price,tired_sale_area,tired_sale_number,tired_sale_amount,tired_sale_price,tired_complete_area,tired_complete_number,tired_complete_amount,tired_complete_price,stock_area,stock_number,stock_amount,stock_price,sale_area,sale_sleeve,sale_amount,sale_price,supply_area,supply_sleeve,supply_amount,supply_price,sales_area,sales_sleeve,sales_amount,sales_price,jan_supply_area,jan_supply_sleeve,jan_supply_amount,jan_sales_area,jan_sales_sleeve,jan_sales_amount,feb_supply_area,feb_supply_sleeve,feb_supply_amount,feb_sales_area,feb_sales_sleeve,feb_sales_amount,mar_supply_area,mar_supply_sleeve,mar_supply_amount,mar_sales_area,mar_sales_sleeve,mar_sales_amount,apr_supply_area,apr_supply_sleeve,apr_supply_amount,apr_sales_area,apr_sales_sleeve,apr_sales_amount,may_supply_area,may_supply_sleeve,may_supply_amount,may_sales_area,may_sales_sleeve,may_sales_amount,june_supply_area,june_supply_sleeve,june_supply_amount,june_sales_area,june_sales_sleeve,june_sales_amount,july_supply_area,july_supply_sleeve,july_supply_amount,july_sales_area,july_sales_sleeve,july_sales_amount,aug_supply_area,aug_supply_sleeve,aug_supply_amount,aug_sales_area,aug_sales_sleeve,aug_sales_amount,sep_supply_area,sep_supply_sleeve,sep_supply_amount,sep_sales_area,sep_sales_sleeve,sep_sales_amount,oct_supply_area,oct_supply_sleeve,oct_supply_amount,oct_sales_area,oct_sales_sleeve,oct_sales_amount,nov_supply_area,nov_supply_sleeve,nov_supply_amount,nov_sales_area,nov_sales_sleeve,nov_sales_amount,dec_supply_area,dec_supply_sleeve,dec_supply_amount,dec_sales_area,dec_sales_sleeve,dec_sales_amount,supply_one_amount,supply_one_ratio,supply_two_amount,supply_two_ratio,supply_three_amount,supply_three_ratio,supply_four_amount,supply_four_ratio,sales_one_amount,sales_one_ratio,sales_two_amount,sales_two_ratio,sales_three_amount,sales_three_ratio,sales_four_amount,sales_four_ratio,desalination_rate,ny_first_supply_area,ny_first_supply_number,ny_first_supply_amount,ny_first_sale_area,ny_first_sale_number,ny_first_sale_amount,ny_second_supply_area,ny_second_supply_number,ny_second_supply_amount,ny_second_sale_area,ny_second_sale_number,ny_second_sale_amount,ny_third_supply_area,ny_third_supply_number,ny_third_supply_amount,ny_third_sale_area,ny_third_sale_number,ny_third_sale_amount,ny_fourth_supply_area,ny_fourth_supply_number,ny_fourth_supply_amount,ny_fourth_sale_area,ny_fourth_sale_number,ny_fourth_sale_amount,ncy_first_supply_area,ncy_first_supply_number,ncy_first_supply_amount,ncy_first_sale_area,ncy_first_sale_number,ncy_first_sale_amount,ncy_second_supply_area,ncy_second_supply_number,ncy_second_supply_amount,ncy_second_sale_area,ncy_second_sale_number,ncy_second_sale_amount,ncy_third_supply_area,ncy_third_supply_number,ncy_third_supply_amount,ncy_third_sale_area,ncy_third_sale_number,ncy_third_sale_amount,ncy_fourth_supply_area,ncy_fourth_supply_number,ncy_fourth_supply_amount,ncy_fourth_sale_area,ncy_fourth_sale_number,ncy_fourth_sale_amount,nty_first_supply_area,nty_first_supply_number,nty_first_supply_amount,nty_first_sale_area,nty_first_sale_number,nty_first_sale_amount,nty_second_supply_area,nty_second_supply_number,nty_second_supply_amount,nty_second_sale_area,nty_second_sale_number,nty_second_sale_amount,nty_third_supply_area,nty_third_supply_number,nty_third_supply_amount,nty_third_sale_area,nty_third_sale_number,nty_third_sale_amount,nty_fourth_supply_area,nty_fourth_supply_number,nty_fourth_supply_amount,nty_fourth_sale_area,nty_fourth_sale_number,nty_fourth_sale_amount,nfy_first_supply_area,nfy_first_supply_number,nfy_first_supply_amount,nfy_first_sale_area,nfy_first_sale_number,nfy_first_sale_amount,nfy_second_supply_area,nfy_second_supply_number,nfy_second_supply_amount,nfy_second_sale_area,nfy_second_sale_number,nfy_second_sale_amount,nfy_third_supply_area,nfy_third_supply_number,nfy_third_supply_amount,nfy_third_sale_area,nfy_third_sale_number,nfy_third_sale_amount,nfy_fourth_supply_area,nfy_fourth_supply_number,nfy_fourth_supply_amount,nfy_fourth_sale_area,nfy_fourth_sale_number,nfy_fourth_sale_amount,created,creator_id,creator,modified,modifier_id,modifier,fma_saleable_area,fma_saleable_number,fma_saleable_amount,fma_saleable_price,fma_tired_sale_area,fma_tired_sale_number,fma_tired_sale_amount,fma_tired_sale_price,fma_tired_complete_area,fma_tired_complete_number,fma_tired_complete_amount,fma_tired_complete_price,fma_stock_area,fma_stock_number,fma_stock_amount,fma_stock_price,fma_sale_area,fma_sale_sleeve,fma_sale_amount,fma_sale_price,fma_supply_area,fma_supply_sleeve,fma_supply_amount,fma_supply_price,fma_sales_area,fma_sales_sleeve,fma_sales_amount,fma_sales_price,fma_jan_supply_area,fma_jan_supply_sleeve,fma_jan_supply_amount,fma_jan_sales_area,fma_jan_sales_sleeve,fma_jan_sales_amount,fma_feb_supply_area,fma_feb_supply_sleeve,fma_feb_supply_amount,fma_feb_sales_area,fma_feb_sales_sleeve,fma_feb_sales_amount,fma_mar_supply_area,fma_mar_supply_sleeve,fma_mar_supply_amount,fma_mar_sales_area,fma_mar_sales_sleeve,fma_mar_sales_amount,fma_apr_supply_area,fma_apr_supply_sleeve,fma_apr_supply_amount,fma_apr_sales_area,fma_apr_sales_sleeve,fma_apr_sales_amount,fma_may_supply_area,fma_may_supply_sleeve,fma_may_supply_amount,fma_may_sales_area,fma_may_sales_sleeve,fma_may_sales_amount,fma_june_supply_area,fma_june_supply_sleeve,fma_june_supply_amount,fma_june_sales_area,fma_june_sales_sleeve,fma_june_sales_amount,fma_july_supply_area,fma_july_supply_sleeve,fma_july_supply_amount,fma_july_sales_area,fma_july_sales_sleeve,fma_july_sales_amount,fma_aug_supply_area,fma_aug_supply_sleeve,fma_aug_supply_amount,fma_aug_sales_area,fma_aug_sales_sleeve,fma_aug_sales_amount,fma_sep_supply_area,fma_sep_supply_sleeve,fma_sep_supply_amount,fma_sep_sales_area,fma_sep_sales_sleeve,fma_sep_sales_amount,fma_oct_supply_area,fma_oct_supply_sleeve,fma_oct_supply_amount,fma_oct_sales_area,fma_oct_sales_sleeve,fma_oct_sales_amount,fma_nov_supply_area,fma_nov_supply_sleeve,fma_nov_supply_amount,fma_nov_sales_area,fma_nov_sales_sleeve,fma_nov_sales_amount,fma_dec_supply_area,fma_dec_supply_sleeve,fma_dec_supply_amount,fma_dec_sales_area,fma_dec_sales_sleeve,fma_dec_sales_amount,fma_supply_one_amount,fma_supply_one_ratio,fma_supply_two_amount,fma_supply_two_ratio,fma_supply_three_amount,fma_supply_three_ratio,fma_supply_four_amount,fma_supply_four_ratio,fma_sales_one_amount,fma_sales_one_ratio,fma_sales_two_amount,fma_sales_two_ratio,fma_sales_three_amount,fma_sales_three_ratio,fma_sales_four_amount,fma_sales_four_ratio,fma_desalination_rate,fma_ny_first_supply_area,fma_ny_first_supply_number,fma_ny_first_supply_amount,fma_ny_first_sale_area,fma_ny_first_sale_number,fma_ny_first_sale_amount,fma_ny_second_supply_area,fma_ny_second_supply_number,fma_ny_second_supply_amount,fma_ny_second_sale_area,fma_ny_second_sale_number,fma_ny_second_sale_amount,fma_ny_third_supply_area,fma_ny_third_supply_number,fma_ny_third_supply_amount,fma_ny_third_sale_area,fma_ny_third_sale_number,fma_ny_third_sale_amount,fma_ny_fourth_supply_area,fma_ny_fourth_supply_number,fma_ny_fourth_supply_amount,fma_ny_fourth_sale_area,fma_ny_fourth_sale_number,fma_ny_fourth_sale_amount,fma_ncy_first_supply_area,fma_ncy_first_supply_number,fma_ncy_first_supply_amount,fma_ncy_first_sale_area,fma_ncy_first_sale_number,fma_ncy_first_sale_amount,fma_ncy_second_supply_area,fma_ncy_second_supply_number,fma_ncy_second_supply_amount,fma_ncy_second_sale_area,fma_ncy_second_sale_number,fma_ncy_second_sale_amount,fma_ncy_third_supply_area,fma_ncy_third_supply_number,fma_ncy_third_supply_amount,fma_ncy_third_sale_area,fma_ncy_third_sale_number,fma_ncy_third_sale_amount,fma_ncy_fourth_supply_area,fma_ncy_fourth_supply_number,fma_ncy_fourth_supply_amount,fma_ncy_fourth_sale_area,fma_ncy_fourth_sale_number,fma_ncy_fourth_sale_amount,fma_nty_first_supply_area,fma_nty_first_supply_number,fma_nty_first_supply_amount,fma_nty_first_sale_area,fma_nty_first_sale_number,fma_nty_first_sale_amount,fma_nty_second_supply_area,fma_nty_second_supply_number,fma_nty_second_supply_amount,fma_nty_second_sale_area,fma_nty_second_sale_number,fma_nty_second_sale_amount,fma_nty_third_supply_area,fma_nty_third_supply_number,fma_nty_third_supply_amount,fma_nty_third_sale_area,fma_nty_third_sale_number,fma_nty_third_sale_amount,fma_nty_fourth_supply_area,fma_nty_fourth_supply_number,fma_nty_fourth_supply_amount,fma_nty_fourth_sale_area,fma_nty_fourth_sale_number,fma_nty_fourth_sale_amount,fma_nfy_first_supply_area,fma_nfy_first_supply_number,fma_nfy_first_supply_amount,fma_nfy_first_sale_area,fma_nfy_first_sale_number,fma_nfy_first_sale_amount,fma_nfy_second_supply_area,fma_nfy_second_supply_number,fma_nfy_second_supply_amount,fma_nfy_second_sale_area,fma_nfy_second_sale_number,fma_nfy_second_sale_amount,fma_nfy_third_supply_area,fma_nfy_third_supply_number,fma_nfy_third_supply_amount,fma_nfy_third_sale_area,fma_nfy_third_sale_number,fma_nfy_third_sale_amount,fma_nfy_fourth_supply_area,fma_nfy_fourth_supply_number,fma_nfy_fourth_supply_amount,fma_nfy_fourth_sale_area,fma_nfy_fourth_sale_number,fma_nfy_fourth_sale_amount)
SELECT sys_guid(),planyear,parent_id,level_code,order_code,id,object_name,object_type,saleable_area,saleable_number,saleable_amount,saleable_price,tired_sale_area,tired_sale_number,tired_sale_amount,tired_sale_price,tired_complete_area,tired_complete_number,tired_complete_amount,tired_complete_price,stock_area,stock_number,stock_amount,stock_price,sale_area,sale_sleeve,sale_amount,sale_price,supply_area,supply_sleeve,supply_amount,supply_price,sales_area,sales_sleeve,sales_amount,sales_price,jan_supply_area,jan_supply_sleeve,jan_supply_amount,jan_sales_area,jan_sales_sleeve,jan_sales_amount,feb_supply_area,feb_supply_sleeve,feb_supply_amount,feb_sales_area,feb_sales_sleeve,feb_sales_amount,mar_supply_area,mar_supply_sleeve,mar_supply_amount,mar_sales_area,mar_sales_sleeve,mar_sales_amount,apr_supply_area,apr_supply_sleeve,apr_supply_amount,apr_sales_area,apr_sales_sleeve,apr_sales_amount,may_supply_area,may_supply_sleeve,may_supply_amount,may_sales_area,may_sales_sleeve,may_sales_amount,june_supply_area,june_supply_sleeve,june_supply_amount,june_sales_area,june_sales_sleeve,june_sales_amount,july_supply_area,july_supply_sleeve,july_supply_amount,july_sales_area,july_sales_sleeve,july_sales_amount,aug_supply_area,aug_supply_sleeve,aug_supply_amount,aug_sales_area,aug_sales_sleeve,aug_sales_amount,sep_supply_area,sep_supply_sleeve,sep_supply_amount,sep_sales_area,sep_sales_sleeve,sep_sales_amount,oct_supply_area,oct_supply_sleeve,oct_supply_amount,oct_sales_area,oct_sales_sleeve,oct_sales_amount,nov_supply_area,nov_supply_sleeve,nov_supply_amount,nov_sales_area,nov_sales_sleeve,nov_sales_amount,dec_supply_area,dec_supply_sleeve,dec_supply_amount,dec_sales_area,dec_sales_sleeve,dec_sales_amount,supply_one_amount,supply_one_ratio,supply_two_amount,supply_two_ratio,supply_three_amount,supply_three_ratio,supply_four_amount,supply_four_ratio,sales_one_amount,sales_one_ratio,sales_two_amount,sales_two_ratio,sales_three_amount,sales_three_ratio,sales_four_amount,sales_four_ratio,desalination_rate,ny_first_supply_area,ny_first_supply_number,ny_first_supply_amount,ny_first_sale_area,ny_first_sale_number,ny_first_sale_amount,ny_second_supply_area,ny_second_supply_number,ny_second_supply_amount,ny_second_sale_area,ny_second_sale_number,ny_second_sale_amount,ny_third_supply_area,ny_third_supply_number,ny_third_supply_amount,ny_third_sale_area,ny_third_sale_number,ny_third_sale_amount,ny_fourth_supply_area,ny_fourth_supply_number,ny_fourth_supply_amount,ny_fourth_sale_area,ny_fourth_sale_number,ny_fourth_sale_amount,ncy_first_supply_area,ncy_first_supply_number,ncy_first_supply_amount,ncy_first_sale_area,ncy_first_sale_number,ncy_first_sale_amount,ncy_second_supply_area,ncy_second_supply_number,ncy_second_supply_amount,ncy_second_sale_area,ncy_second_sale_number,ncy_second_sale_amount,ncy_third_supply_area,ncy_third_supply_number,ncy_third_supply_amount,ncy_third_sale_area,ncy_third_sale_number,ncy_third_sale_amount,ncy_fourth_supply_area,ncy_fourth_supply_number,ncy_fourth_supply_amount,ncy_fourth_sale_area,ncy_fourth_sale_number,ncy_fourth_sale_amount,nty_first_supply_area,nty_first_supply_number,nty_first_supply_amount,nty_first_sale_area,nty_first_sale_number,nty_first_sale_amount,nty_second_supply_area,nty_second_supply_number,nty_second_supply_amount,nty_second_sale_area,nty_second_sale_number,nty_second_sale_amount,nty_third_supply_area,nty_third_supply_number,nty_third_supply_amount,nty_third_sale_area,nty_third_sale_number,nty_third_sale_amount,nty_fourth_supply_area,nty_fourth_supply_number,nty_fourth_supply_amount,nty_fourth_sale_area,nty_fourth_sale_number,nty_fourth_sale_amount,nfy_first_supply_area,nfy_first_supply_number,nfy_first_supply_amount,nfy_first_sale_area,nfy_first_sale_number,nfy_first_sale_amount,nfy_second_supply_area,nfy_second_supply_number,nfy_second_supply_amount,nfy_second_sale_area,nfy_second_sale_number,nfy_second_sale_amount,nfy_third_supply_area,nfy_third_supply_number,nfy_third_supply_amount,nfy_third_sale_area,nfy_third_sale_number,nfy_third_sale_amount,nfy_fourth_supply_area,nfy_fourth_supply_number,nfy_fourth_supply_amount,nfy_fourth_sale_area,nfy_fourth_sale_number,nfy_fourth_sale_amount,created,creator_id,creator,modified,modifier_id,modifier,fma_saleable_area,fma_saleable_number,fma_saleable_amount,fma_saleable_price,fma_tired_sale_area,fma_tired_sale_number,fma_tired_sale_amount,fma_tired_sale_price,fma_tired_complete_area,fma_tired_complete_number,fma_tired_complete_amount,fma_tired_complete_price,fma_stock_area,fma_stock_number,fma_stock_amount,fma_stock_price,fma_sale_area,fma_sale_sleeve,fma_sale_amount,fma_sale_price,fma_supply_area,fma_supply_sleeve,fma_supply_amount,fma_supply_price,fma_sales_area,fma_sales_sleeve,fma_sales_amount,fma_sales_price,fma_jan_supply_area,fma_jan_supply_sleeve,fma_jan_supply_amount,fma_jan_sales_area,fma_jan_sales_sleeve,fma_jan_sales_amount,fma_feb_supply_area,fma_feb_supply_sleeve,fma_feb_supply_amount,fma_feb_sales_area,fma_feb_sales_sleeve,fma_feb_sales_amount,fma_mar_supply_area,fma_mar_supply_sleeve,fma_mar_supply_amount,fma_mar_sales_area,fma_mar_sales_sleeve,fma_mar_sales_amount,fma_apr_supply_area,fma_apr_supply_sleeve,fma_apr_supply_amount,fma_apr_sales_area,fma_apr_sales_sleeve,fma_apr_sales_amount,fma_may_supply_area,fma_may_supply_sleeve,fma_may_supply_amount,fma_may_sales_area,fma_may_sales_sleeve,fma_may_sales_amount,fma_june_supply_area,fma_june_supply_sleeve,fma_june_supply_amount,fma_june_sales_area,fma_june_sales_sleeve,fma_june_sales_amount,fma_july_supply_area,fma_july_supply_sleeve,fma_july_supply_amount,fma_july_sales_area,fma_july_sales_sleeve,fma_july_sales_amount,fma_aug_supply_area,fma_aug_supply_sleeve,fma_aug_supply_amount,fma_aug_sales_area,fma_aug_sales_sleeve,fma_aug_sales_amount,fma_sep_supply_area,fma_sep_supply_sleeve,fma_sep_supply_amount,fma_sep_sales_area,fma_sep_sales_sleeve,fma_sep_sales_amount,fma_oct_supply_area,fma_oct_supply_sleeve,fma_oct_supply_amount,fma_oct_sales_area,fma_oct_sales_sleeve,fma_oct_sales_amount,fma_nov_supply_area,fma_nov_supply_sleeve,fma_nov_supply_amount,fma_nov_sales_area,fma_nov_sales_sleeve,fma_nov_sales_amount,fma_dec_supply_area,fma_dec_supply_sleeve,fma_dec_supply_amount,fma_dec_sales_area,fma_dec_sales_sleeve,fma_dec_sales_amount,fma_supply_one_amount,fma_supply_one_ratio,fma_supply_two_amount,fma_supply_two_ratio,fma_supply_three_amount,fma_supply_three_ratio,fma_supply_four_amount,fma_supply_four_ratio,fma_sales_one_amount,fma_sales_one_ratio,fma_sales_two_amount,fma_sales_two_ratio,fma_sales_three_amount,fma_sales_three_ratio,fma_sales_four_amount,fma_sales_four_ratio,fma_desalination_rate,fma_ny_first_supply_area,fma_ny_first_supply_number,fma_ny_first_supply_amount,fma_ny_first_sale_area,fma_ny_first_sale_number,fma_ny_first_sale_amount,fma_ny_second_supply_area,fma_ny_second_supply_number,fma_ny_second_supply_amount,fma_ny_second_sale_area,fma_ny_second_sale_number,fma_ny_second_sale_amount,fma_ny_third_supply_area,fma_ny_third_supply_number,fma_ny_third_supply_amount,fma_ny_third_sale_area,fma_ny_third_sale_number,fma_ny_third_sale_amount,fma_ny_fourth_supply_area,fma_ny_fourth_supply_number,fma_ny_fourth_supply_amount,fma_ny_fourth_sale_area,fma_ny_fourth_sale_number,fma_ny_fourth_sale_amount,fma_ncy_first_supply_area,fma_ncy_first_supply_number,fma_ncy_first_supply_amount,fma_ncy_first_sale_area,fma_ncy_first_sale_number,fma_ncy_first_sale_amount,fma_ncy_second_supply_area,fma_ncy_second_supply_number,fma_ncy_second_supply_amount,fma_ncy_second_sale_area,fma_ncy_second_sale_number,fma_ncy_second_sale_amount,fma_ncy_third_supply_area,fma_ncy_third_supply_number,fma_ncy_third_supply_amount,fma_ncy_third_sale_area,fma_ncy_third_sale_number,fma_ncy_third_sale_amount,fma_ncy_fourth_supply_area,fma_ncy_fourth_supply_number,fma_ncy_fourth_supply_amount,fma_ncy_fourth_sale_area,fma_ncy_fourth_sale_number,fma_ncy_fourth_sale_amount,fma_nty_first_supply_area,fma_nty_first_supply_number,fma_nty_first_supply_amount,fma_nty_first_sale_area,fma_nty_first_sale_number,fma_nty_first_sale_amount,fma_nty_second_supply_area,fma_nty_second_supply_number,fma_nty_second_supply_amount,fma_nty_second_sale_area,fma_nty_second_sale_number,fma_nty_second_sale_amount,fma_nty_third_supply_area,fma_nty_third_supply_number,fma_nty_third_supply_amount,fma_nty_third_sale_area,fma_nty_third_sale_number,fma_nty_third_sale_amount,fma_nty_fourth_supply_area,fma_nty_fourth_supply_number,fma_nty_fourth_supply_amount,fma_nty_fourth_sale_area,fma_nty_fourth_sale_number,fma_nty_fourth_sale_amount,fma_nfy_first_supply_area,fma_nfy_first_supply_number,fma_nfy_first_supply_amount,fma_nfy_first_sale_area,fma_nfy_first_sale_number,fma_nfy_first_sale_amount,fma_nfy_second_supply_area,fma_nfy_second_supply_number,fma_nfy_second_supply_amount,fma_nfy_second_sale_area,fma_nfy_second_sale_number,fma_nfy_second_sale_amount,fma_nfy_third_supply_area,fma_nfy_third_supply_number,fma_nfy_third_supply_amount,fma_nfy_third_sale_area,fma_nfy_third_sale_number,fma_nfy_third_sale_amount,fma_nfy_fourth_supply_area,fma_nfy_fourth_supply_number,fma_nfy_fourth_supply_amount,fma_nfy_fourth_sale_area,fma_nfy_fourth_sale_number,fma_nfy_fourth_sale_amount
FROM opm_t_REGION_inventory_plan WHERE  BELONG_REGION_ID=regionCompanyId or 1=init_all ;
-----------------------------------供销存
END P_OPM_INIT_REGION_INVENTORY;
/
----- select * from opm_REGION_cash order by plan_year,lpad( order_code, 10, '0' ); delete from opm_REGION_cash
create or replace PROCEDURE "P_OPM_INIT_REGION_OPERATING" (planyear IN number--计划年
,regionCompanyId IN VARCHAR2--区域公司id
) AS-- 根据模板初始化年度【区域级数据】--经营计划
-- 注意：初始化结构顺序及公式、具体值由区域级提交后汇总
--作者： chenl--日期： 2021/08/24 FIELDSINFO SYS_REFCURSOR;
--是否引入全部模板
init_all   VARCHAR2(500):=(case when regionCompanyId is null or regionCompanyId='' then 1 else 0 end); 
BEGIN 
-----------------------------------经营计划
--删除该年；
DELETE FROM OPM_REGION_INVENTORY_PLAN WHERE  (BELONG_REGION_ID=regionCompanyId or 1=init_all) and plan_year=planyear ;
INSERT INTO opm_region_operating_plan (id,plan_year,parent_id,level_code,order_code,object_type,belong_region_id,object_id,object_name,railway_bool,estate_bool,estate_ratio,railway_ratio,build_land_area,surface_total_area,above_ground_area,construction_stage,total_investment,total_saleable_area,total_value,last_started_area,last_completed_area,this_started_area,this_completed_area,todec_due_time,todec_delivery_installment,cutoff_started_area,cutoff_completed_area,next_started_area,next_completed_area,next_due_time,next_delivery_installment,cutoff_last_started_area,cutoff_last_completed_area,cutoff_sales_area,cotoff_sales_amount,remaining_value_area,remaining_value_amount,added_supply_area,added_supply_amount,expected_sales_area,expected_sales_amount,equity_sales_amount,tired_supply_area,tired_supply_amount,tired_sales_area,tired_sales_amount,tired_stock_area,tired_stock_amount,tired_remaining_area,tired_remaining_amount,forecast_supply_area,forecast_supply_amount,forecast_sales_area,forecast_sales_amount,forecast_equity_amount,forecast_tired_area,forecast_tired_amount,forecast_cotoff_area,forecast_cotoff_amount,forecast_stock_area,forecast_stock_amount,forecast_remaining_area,forecast_remaining_amount,sac_last_sale_amount,sac_last_unpaid_amount,sac_then_sale_amount,sac_then_equity_sale,tried_sale_amount,tried_unpaid_amount,sac_next_sale_amount,sac_next_equity_sale,sac_tried_sale_amount,sac_tried_unpaid_amount,inv_last_investment,inv_then_actual,inv_then_payment,inv_invest_firm,inv_external_financing,inv_sales_collection,inv_land_price,inv_then_investment,inv_plan_investment,inv_invest_funds,inv_next_invest_funds,inv_next_external_finan,inv_next_sales_collection,inv_next_land_price,inv_next_investment,ltopera_income,ltopera_income_outside,ltopera_income_inside,lttotal_profit,ltprofit_inside,ltprofit_outside,ltprofit_outside_equity,ltprofit_inside_equity,thopera_income,thopera_income_outside,thopera_income_inside,thtotal_profit,thprofit_inside,thprofit_outside,thprofit_outside_equity,thprofit_inside_equity,end_opera_income,end_opera_income_outside,end_opera_income_inside,end_total_profit,end_profit_inside,end_profit_outside,end_profit_outside_equity,end_profit_inside_equity,ntprofit_inside_equity,ntopera_income_outside,ntopera_income_inside,nttotal_profit,ntprofit_inside,ntprofit_outside,ntprofit_outside_equity,ntprofit_rights_equity,entnt_opera_income,entnt_opera_income_out,entnt_opera_income_ins,entnt_total_profit,entnt_profit_inside,entnt_profit_outside,entnt_profit_out_equity,entnt_profit_ins_equity,own_return_time,full_return_time,freed_value,tomar_opera_income,tomar_opera_income_ins,tomar_total_profit,tomar_profit_inside,tomar_profit_equity,toapr_opera_income,toapr_opera_income_ins,toapr_total_profit,toapr_profit_inside,toapr_profit_equity,created,creator_id,creator,modified,modifier_id,modifier,fma_construction_stage,fma_total_investment,fma_total_saleable_area,fma_total_value,fma_last_started_area,fma_last_completed_area,fma_this_started_area,fma_this_completed_area,fma_todec_due_time,fma_todec_delivery_installment,fma_cutoff_started_area,fma_cutoff_completed_area,fma_next_started_area,fma_next_completed_area,fma_next_due_time,fma_next_delivery_installment,fma_cutoff_last_started_area,fma_cutoff_last_completed_area,fma_cutoff_sales_area,fma_cotoff_sales_amount,fma_remaining_value_area,fma_remaining_value_amount,fma_added_supply_area,fma_added_supply_amount,fma_expected_sales_area,fma_expected_sales_amount,fma_equity_sales_amount,fma_tired_supply_area,fma_tired_supply_amount,fma_tired_sales_area,fma_tired_sales_amount,fma_tired_stock_area,fma_tired_stock_amount,fma_tired_remaining_area,fma_tired_remaining_amount,fma_forecast_supply_area,fma_forecast_supply_amount,fma_forecast_sales_area,fma_forecast_sales_amount,fma_forecast_equity_amount,fma_forecast_tired_area,fma_forecast_tired_amount,fma_forecast_cotoff_area,fma_forecast_cotoff_amount,fma_forecast_stock_area,fma_forecast_stock_amount,fma_forecast_remaining_area,fma_forecast_remaining_amount,fma_sac_last_sale_amount,fma_sac_last_unpaid_amount,fma_sac_then_sale_amount,fma_sac_then_equity_sale,fma_tried_sale_amount,fma_tried_unpaid_amount,fma_sac_next_sale_amount,fma_sac_next_equity_sale,fma_sac_tried_sale_amount,fma_sac_tried_unpaid_amount,fma_inv_last_investment,fma_inv_then_actual,fma_inv_then_payment,fma_inv_invest_firm,fma_inv_external_financing,fma_inv_sales_collection,fma_inv_land_price,fma_inv_then_investment,fma_inv_plan_investment,fma_inv_invest_funds,fma_inv_next_invest_funds,fma_inv_next_external_finan,fma_inv_next_sales_collection,fma_inv_next_land_price,fma_inv_next_investment,fma_ltopera_income,fma_ltopera_income_outside,fma_ltopera_income_inside,fma_lttotal_profit,fma_ltprofit_inside,fma_ltprofit_outside,fma_ltprofit_outside_equity,fma_ltprofit_inside_equity,fma_thopera_income,fma_thopera_income_outside,fma_thopera_income_inside,fma_thtotal_profit,fma_thprofit_inside,fma_thprofit_outside,fma_thprofit_outside_equity,fma_thprofit_inside_equity,fma_end_opera_income,fma_end_opera_income_outside,fma_end_opera_income_inside,fma_end_total_profit,fma_end_profit_inside,fma_end_profit_outside,fma_end_profit_outside_equity,fma_end_profit_inside_equity,fma_ntprofit_inside_equity,fma_ntopera_income_outside,fma_ntopera_income_inside,fma_nttotal_profit,fma_ntprofit_inside,fma_ntprofit_outside,fma_ntprofit_outside_equity,fma_ntprofit_rights_equity,fma_entnt_opera_income,fma_entnt_opera_income_out,fma_entnt_opera_income_ins,fma_entnt_total_profit,fma_entnt_profit_inside,fma_entnt_profit_outside,fma_entnt_profit_out_equity,fma_entnt_profit_ins_equity,fma_own_return_time,fma_full_return_time,fma_freed_value,fma_tomar_opera_income,fma_tomar_opera_income_ins,fma_tomar_total_profit,fma_tomar_profit_inside,fma_tomar_profit_equity,fma_toapr_opera_income,fma_toapr_opera_income_ins,fma_toapr_total_profit,fma_toapr_profit_inside,fma_toapr_profit_equity,fma_railway_bool,fma_estate_bool,fma_estate_ratio,fma_railway_ratio,fma_build_land_area,fma_surface_total_area,fma_above_ground_area) 
select sys_guid(),planyear,parent_id,level_code,order_code,object_type,belong_region_id,object_id,object_name,railway_bool,estate_bool,estate_ratio,railway_ratio,build_land_area,surface_total_area,above_ground_area,construction_stage,total_investment,total_saleable_area,total_value,last_started_area,last_completed_area,this_started_area,this_completed_area,todec_due_time,todec_delivery_installment,cutoff_started_area,cutoff_completed_area,next_started_area,next_completed_area,next_due_time,next_delivery_installment,cutoff_last_started_area,cutoff_last_completed_area,cutoff_sales_area,cotoff_sales_amount,remaining_value_area,remaining_value_amount,added_supply_area,added_supply_amount,expected_sales_area,expected_sales_amount,equity_sales_amount,tired_supply_area,tired_supply_amount,tired_sales_area,tired_sales_amount,tired_stock_area,tired_stock_amount,tired_remaining_area,tired_remaining_amount,forecast_supply_area,forecast_supply_amount,forecast_sales_area,forecast_sales_amount,forecast_equity_amount,forecast_tired_area,forecast_tired_amount,forecast_cotoff_area,forecast_cotoff_amount,forecast_stock_area,forecast_stock_amount,forecast_remaining_area,forecast_remaining_amount,sac_last_sale_amount,sac_last_unpaid_amount,sac_then_sale_amount,sac_then_equity_sale,tried_sale_amount,tried_unpaid_amount,sac_next_sale_amount,sac_next_equity_sale,sac_tried_sale_amount,sac_tried_unpaid_amount,inv_last_investment,inv_then_actual,inv_then_payment,inv_invest_firm,inv_external_financing,inv_sales_collection,inv_land_price,inv_then_investment,inv_plan_investment,inv_invest_funds,inv_next_invest_funds,inv_next_external_finan,inv_next_sales_collection,inv_next_land_price,inv_next_investment,ltopera_income,ltopera_income_outside,ltopera_income_inside,lttotal_profit,ltprofit_inside,ltprofit_outside,ltprofit_outside_equity,ltprofit_inside_equity,thopera_income,thopera_income_outside,thopera_income_inside,thtotal_profit,thprofit_inside,thprofit_outside,thprofit_outside_equity,thprofit_inside_equity,end_opera_income,end_opera_income_outside,end_opera_income_inside,end_total_profit,end_profit_inside,end_profit_outside,end_profit_outside_equity,end_profit_inside_equity,ntprofit_inside_equity,ntopera_income_outside,ntopera_income_inside,nttotal_profit,ntprofit_inside,ntprofit_outside,ntprofit_outside_equity,ntprofit_rights_equity,entnt_opera_income,entnt_opera_income_out,entnt_opera_income_ins,entnt_total_profit,entnt_profit_inside,entnt_profit_outside,entnt_profit_out_equity,entnt_profit_ins_equity,own_return_time,full_return_time,freed_value,tomar_opera_income,tomar_opera_income_ins,tomar_total_profit,tomar_profit_inside,tomar_profit_equity,toapr_opera_income,toapr_opera_income_ins,toapr_total_profit,toapr_profit_inside,toapr_profit_equity,created,creator_id,creator,modified,modifier_id,modifier,fma_construction_stage,fma_total_investment,fma_total_saleable_area,fma_total_value,fma_last_started_area,fma_last_completed_area,fma_this_started_area,fma_this_completed_area,fma_todec_due_time,fma_todec_delivery_installment,fma_cutoff_started_area,fma_cutoff_completed_area,fma_next_started_area,fma_next_completed_area,fma_next_due_time,fma_next_delivery_installment,fma_cutoff_last_started_area,fma_cutoff_last_completed_area,fma_cutoff_sales_area,fma_cotoff_sales_amount,fma_remaining_value_area,fma_remaining_value_amount,fma_added_supply_area,fma_added_supply_amount,fma_expected_sales_area,fma_expected_sales_amount,fma_equity_sales_amount,fma_tired_supply_area,fma_tired_supply_amount,fma_tired_sales_area,fma_tired_sales_amount,fma_tired_stock_area,fma_tired_stock_amount,fma_tired_remaining_area,fma_tired_remaining_amount,fma_forecast_supply_area,fma_forecast_supply_amount,fma_forecast_sales_area,fma_forecast_sales_amount,fma_forecast_equity_amount,fma_forecast_tired_area,fma_forecast_tired_amount,fma_forecast_cotoff_area,fma_forecast_cotoff_amount,fma_forecast_stock_area,fma_forecast_stock_amount,fma_forecast_remaining_area,fma_forecast_remaining_amount,fma_sac_last_sale_amount,fma_sac_last_unpaid_amount,fma_sac_then_sale_amount,fma_sac_then_equity_sale,fma_tried_sale_amount,fma_tried_unpaid_amount,fma_sac_next_sale_amount,fma_sac_next_equity_sale,fma_sac_tried_sale_amount,fma_sac_tried_unpaid_amount,fma_inv_last_investment,fma_inv_then_actual,fma_inv_then_payment,fma_inv_invest_firm,fma_inv_external_financing,fma_inv_sales_collection,fma_inv_land_price,fma_inv_then_investment,fma_inv_plan_investment,fma_inv_invest_funds,fma_inv_next_invest_funds,fma_inv_next_external_finan,fma_inv_next_sales_collection,fma_inv_next_land_price,fma_inv_next_investment,fma_ltopera_income,fma_ltopera_income_outside,fma_ltopera_income_inside,fma_lttotal_profit,fma_ltprofit_inside,fma_ltprofit_outside,fma_ltprofit_outside_equity,fma_ltprofit_inside_equity,fma_thopera_income,fma_thopera_income_outside,fma_thopera_income_inside,fma_thtotal_profit,fma_thprofit_inside,fma_thprofit_outside,fma_thprofit_outside_equity,fma_thprofit_inside_equity,fma_end_opera_income,fma_end_opera_income_outside,fma_end_opera_income_inside,fma_end_total_profit,fma_end_profit_inside,fma_end_profit_outside,fma_end_profit_outside_equity,fma_end_profit_inside_equity,fma_ntprofit_inside_equity,fma_ntopera_income_outside,fma_ntopera_income_inside,fma_nttotal_profit,fma_ntprofit_inside,fma_ntprofit_outside,fma_ntprofit_outside_equity,fma_ntprofit_rights_equity,fma_entnt_opera_income,fma_entnt_opera_income_out,fma_entnt_opera_income_ins,fma_entnt_total_profit,fma_entnt_profit_inside,fma_entnt_profit_outside,fma_entnt_profit_out_equity,fma_entnt_profit_ins_equity,fma_own_return_time,fma_full_return_time,fma_freed_value,fma_tomar_opera_income,fma_tomar_opera_income_ins,fma_tomar_total_profit,fma_tomar_profit_inside,fma_tomar_profit_equity,fma_toapr_opera_income,fma_toapr_opera_income_ins,fma_toapr_total_profit,fma_toapr_profit_inside,fma_toapr_profit_equity,fma_railway_bool,fma_estate_bool,fma_estate_ratio,fma_railway_ratio,fma_build_land_area,fma_surface_total_area,fma_above_ground_area 
from opm_t_region_operating_plan  WHERE  BELONG_REGION_ID=regionCompanyId or 1=init_all ;
-----------------------------------经营计划
END P_OPM_INIT_REGION_OPERATING;

/
CREATE OR REPLACE PROCEDURE "P_OPM_INIT_REGION" (planyear IN number--计划年
,regionCompanyId IN VARCHAR2--区域公司id
) AS-- 根据模板初始化年度【区域级数据】
-- 注意：初始化结构顺序及公式、具体值由区域级提交后汇总
--作者： chenl--日期： 2021/08/24 FIELDSINFO SYS_REFCURSOR;
BEGIN 
-----------------------------------现金流
  begin
  P_OPM_INIT_REGION_CASH(
    PLANYEAR => PLANYEAR
    ,regionCompanyId=>regionCompanyId
  );
  end;
-----------------------------------供销存
  begin
  P_OPM_INIT_REGION_INVENTORY(
    PLANYEAR => PLANYEAR
     ,regionCompanyId=>regionCompanyId
  );
  end;
-----------------------------------
-----------------------------------经营计划
  begin
   P_OPM_INIT_REGION_OPERATING(
    PLANYEAR => PLANYEAR
     ,regionCompanyId=>regionCompanyId
  );
  end;
-----------------------------------
END P_OPM_INIT_REGION;


